<!DOCTYPE html>
<html>
<head>
  <title>Simple Frontend</title>
</head>
<body>
  <h1>Sprint Planner</h1>
  <pre id="jsonOutput">Loading...</pre>
    <form  id="jsonInput">
        <input type="text" name = "ClassName" placeholder="Class Name"> </input>
        <input type="datetime" name="DueDate" placeholder="4/20/20"> </input>
        <input type="text" name="AssignmentName" placeholder="Assignment Name"></input>
        <input type="text" name="TaskDetails" placeholder="Task Details"></input>
        
        <button type="submit">Click Me!</button>

    </form>

<!-- Reaquests to the backend -->
  <script>

   document.getElementById('jsonInput').addEventListener('submit', function(event) {
    event.preventDefault(); // stop the normal form submission

    const formData = new FormData(event.target);
    const payload = {
        className: formData.get("ClassName"),
        studentName: formData.get("Class"),
        dueDate: formData.get("DueDate"),
        assignmentName: formData.get("AssignmentName")
    };

    fetch("http://localhost:8080/api/add-assignment", {
        method: "POST",
        headers: {
            "Content-Type": "application/json"
        },
        body: JSON.stringify(payload)
    })
    .then(response => response.json())
    .then(data => {
        document.getElementById("result").textContent =
            `Assignment Added: ${data.className} - ${data.assignmentName} (Due: ${data.dueDate})`;
        // Now fetch all assignments and update display
        fetchAssignments();
    })
    .catch(error => {
        console.error("Error:", error);
        document.getElementById("result").textContent = "Failed to submit.";
    });
});


// Fetches values
function fetchAssignments() {
  fetch("http://localhost:8080/api/assignments")
    .then(response => response.json())
    .then(data => {
      const outputDiv = document.getElementById('jsonOutput');
      outputDiv.innerHTML = '';  // Clear previous

      data.forEach(a => {
        const p = document.createElement('p');
        p.textContent = `${a.className}: ${a.assignmentName} (Due: ${a.dueDate})`;
        outputDiv.appendChild(p);
      });
    })
    .catch(err => {
      document.getElementById('jsonOutput').textContent = 'Error fetching assignments';
      console.error(err);
    });
}
  </script>


<div id="result"></div> 
</body>


</html>
